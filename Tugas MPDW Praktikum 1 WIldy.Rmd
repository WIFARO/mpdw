---
title: "Tugas MPDW Praktikum WIldy"
author: "Wildy Fahmi Rosyidi G1401231066"
date: "2025-08-31"
output: html_document
---

```{r}
library("readxl")
library("forecast")
library("graphics")
library("TTR")
library("TSA")
```


```{r}
data_mpdw <- import("https://raw.githubusercontent.com/nyayunabila/mpdw/refs/heads/main/Pertemuan%201/data-kelompok-9-mpdw.csv")
```

```{r}
data_301to400 <- data_mpdw[301:400, ]
data_301to400
```

## Eksplorasi Data

```{r}
str(data_301to400)
dim(data_301to400)
```

### Mengubah ke deret waktu

```{r}
data_dw <- ts(data_301to400$daily_revenue)
```

```{r}
summary(data_dw)
```

### Plot deret waktu

```{r}
ts.plot(data_dw, xlab="Date ", ylab="Daily Revenue", 
        main = "Time Series Plot")
points(data_dw)
```

Dari plot diatas, saya berasumsi data bersifat konstan. Jadi saya akan menggunakan Single Mvoing Average untuk pemulusan

## Pembagian Data

Pembagian data latih dan data uji dilakukan dengan perbandingan 80% data latih dan 20% data uji.

```{r}
data_latih <- data_301to400[1:80,]
data_uji <- data_301to400[81:100,]
data_latih_dw <- ts(data_latih$daily_revenue)
data_uji_dw <- ts(data_uji$daily_revenue)
```

### Plot

```{r}
plot(data_dw, col="red",main="Plot semua data")
points(data_dw)

plot(data_latih_dw, col="blue",main="Plot data latih")
points(data_latih_dw)

plot(data_uji_dw, col="blue",main="Plot data uji")
points(data_uji_dw)
```

### Single Moving Average (SMA)

Pada pemulusan menggunakan SMA ini, parameter yang saya gunakan adalah `m = 4`

```{r}
data_sma <- SMA(data_latih_dw, n=4)
data_sma
```

Hasil data ramal

```{r}
data_ramal <- c(NA,data_sma)
data_ramal
```

Dari hasil pemulusan diatas, bisa diambil nilai peramalan untuk 20 data uji kedepan yaitu 223.72667. Karena dalam SMA, data ramalan `t` periode ke depan akan bernilai sama dengan nilai 1 periode ke depan.

### Peramalan 20 periode kedepan

```{r}
data_gab <- cbind(aktual=c(data_latih_dw,rep(NA,20)),pemulusan=c(data_sma,rep(NA,20)),ramalan=c(data_ramal,rep(data_ramal[length(data_ramal)],19)))
data_gab
```


### Plot hasil peramalan data uji

```{r}
ts.plot(data_dw, xlab="Date ", ylab="Daily Revenue", main= "Single Moving Average dengan N=3 ")
points(data_dw)
lines(data_gab[,2],col="green",lwd=2)
lines(data_gab[,3],col="red",lwd=2)
legend("topleft",c("data aktual","data pemulusan","data peramalan"), lty=8, col=c("black","green","red"), cex=0.5)
```

## Perhitungan Akurasi

```{r}
error_train_sma = data_latih_dw-data_ramal[1:length(data_latih_dw)]
SSE_train_sma = sum(error_train_sma[5:length(data_latih_dw)]^2)
MSE_train_sma = mean(error_train_sma[5:length(data_latih_dw)]^2)
MAPE_train_sma = mean(abs((error_train_sma[5:length(data_latih_dw)]/data_latih_dw[1:length(data_latih_dw)])*100))

akurasi_train_sma <- matrix(c(SSE_train_sma, MSE_train_sma, MAPE_train_sma))
row.names(akurasi_train_sma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_train_sma) <- c("Akurasi m = 4")
akurasi_train_sma
```

Hasil MAPE yang didapat berupa infinite, yang mana ini kemungkinan diakrenakan ada nilai 0 pada `data_latih_dw`. Sehingga menyebabkan ada nilai yang bernilai infinite. Dan ketika di rata-rata akan menghasilkan nilai infinite pula. 

Meskipun pada hasil akurasi untuk data latih sebelumnya didapatkan nilai MAPE infinite, tapi saya akan tetap melanjutkan pengujian untuk data uji nya. Karena pada data uji tidak ada data yang bernilai 0. Jadi diharapakan akan menghasilkan nilai MAPE seperti yang diharapkan

```{r}
error_test_sma = data_uji_dw-data.gab[81:100,3]
SSE_test_sma = sum(error_test_sma^2)
MSE_test_sma = mean(error_test_sma^2)
MAPE_test_sma = mean(abs((error_test_sma/data_uji_dw*100)))

akurasi_test_sma <- matrix(c(SSE_test_sma, MSE_test_sma, MAPE_test_sma))
row.names(akurasi_test_sma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_test_sma) <- c("Akurasi m = 4")
akurasi_test_sma
```

Nilai MAPE yang didapat untuk data uji ternyata sangatlah tinggi. Berarti model memiliki nilai akurasi yang sangat buruk, dan memerlukan model pemulusan yang lain.













