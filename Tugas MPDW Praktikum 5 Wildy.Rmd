---
title: "MPDW Pertemuan 5"
author: "Wildy Fahmi Rosyidi G1401231066"
date: "2025-10-01"
output: html_document
---

```{r}
library(ggplot2)
library(tsibble)
library(tseries)
library(MASS)
library(rio)
```

## Input Data

```{r}
data_mpdw <- import("https://raw.githubusercontent.com/nyayunabila/mpdw/refs/heads/main/data%20kelompok%209%20-%20Sheet1.csv")
head(data_mpdw)
```

```{r}
data_301to400 <- data_mpdw[301:400, ]
data_301to400
```

## Plot Time Series

```{r}
data_301to400$daily_revenue <- gsub(",", ".", data_301to400$daily_revenue)

data_301to400$daily_revenue <- as.numeric(data_301to400$daily_revenue)

data_pertemuan5 <- ts(data_301to400$daily_revenue)

ts.plot(data_pertemuan5, 
        xlab="Time", 
        ylab="Daily Revenue", 
        main="Time Series Plot",
        lwd=2)
points(data_pertemuan5)
```

```{r}
lattice::densityplot(as.vector(data_pertemuan5))
```

Dari grafik diatas terlihat masih terdapat beberapa pencilan pada data.

## Uji Stasioner Dalam Rataan dan Ragam

### ACF

```{r}
acf(data_pertemuan5)
```

### Uji ADF

```{r}
tseries::adf.test(data_pertemuan5)
```

Karena p-value < 0,05 menandakan bahwa data sudah stasioner dalam rataan.

### Plot Box-Cox

Bila ingin membuat plot box-cox pastikan variabel y nya tidak ada yang 0. Maka akan dicek apakah ada variabel y yang bernilai 0.

```{r}
any(data_301to400$daily_revenue == 0)
```

Ternyata ada data yang bernilai 0. Agar data tidak ada yang berniali 0 maka akan dijumlahkan dengan 1.

```{r}
data_pertemuan5_geser <- data_pertemuan5 + 1
```

```{r}
index <- seq(1:100)
bc = boxcox(data_pertemuan5_geser ~ index, lambda = seq(-1,4,by=0.01))

lambda <- bc$x[which.max(bc$y)]
lambda

bc$x[bc$y > max(bc$y) - 1/2 * qchisq(.95,1)]
```

Dari hasil plot diatas, dalam rentang tidak termasuk nilai lambda = 1. Berarti data tidak stasioner dalam ragam. Dan didapatkan nilai lambda optimum nya `0.61`dengan batas bawahnya `0.42` dan batas atasnya `0.82`

### Transformasi Box-cox

Karena lambda optimum nya mendekati nilai `0,5` maka akan dilakukan transformasi akar terhadap daily revenue

```{r}
data_boxcox <- data_pertemuan5_geser^0.5
```

```{r}
index <- seq(1:100)

bc2 <- boxcox(
  data_boxcox ~ index,
  lambda = seq(0, 5, by = 0.001)
)

lambda <- bc2$x[which.max(bc2$y)]
lambda

ci_lambda <- bc2$x[bc2$y > max(bc2$y) - 0.5 * qchisq(0.95, 1)]

ci_lower <- min(ci_lambda)
ci_upper <- max(ci_lambda)

c(Batas_Bawah = ci_lower, Batas_Atas = ci_upper)
```

Setelah dilakukan transformasi box-cox terlihat bahwa data sudah stasioner dalam ragam.

### Pengecekan Ulang

Untuk memastikan, akan dilakukan pengujian ulang kestasioneran dalam rataan terhadap model yang sudah transformasi 

#### ACF

```{r}
acf(data_boxcox)
```

Kali ini data cutoff pada lag 1

#### Uji ADF

```{r}
tseries::adf.test(data_boxcox)
```

Karena p-value < 0.05. Maka data setelah transformasi sudah stasioner dalam rataan dan juga dalam ragam.



